---
title: '01.重构-介绍'
comments: true
tags:
  - '编程思想'
  - '重构'
categories:
  - 05.编程思想
  - 02.重构
date: 2018-05-29 18:06:26
---

## 1. 定义

- 重构（refactoring）是在不改变软件可观察行为的前提下改善其内部结构。
- 重构是这样一个过程：在不改变代码外在行为的前提下，对代码进行修改，以改进程序的内部结构。
- 重构（名词）：对软件内部结构的一种调整，目的是在不改变软件可观察行为的前提下，提高可理解性，降低其修改成本。
- 重构（动词）：使用一系列重构首发，在不改变软件可观察行为的前提下，调整其结构。

## 2. 原则

- 不改变软件行为只是重构的最基本要求；
- 不需了解软件行为才是目的；
- 个人理解：封装完整性？调用 API 而无需了解 API 内部实现和行为。
- 设计模式为重构提供了目标；

## 3. 经验

- 重构前需建立一组可靠的测试环境，且必须能自我检验；
- 重构技术就是以微小的步伐修改程序，如果出错，可以很容易发现；
- 良好的名称是代码清晰的关键；
- 尽量除去临时变量；
- 最好不要在另一个对象的属性基础上运用 switch 语句，如果不得不使用，也应该在对象自己的数据上使用，而不是在别人的数据上使用；

## 4. 示例

- Replace Type Code with State/Strategy
- Move Method
- Replace Conditional with Polymorphism
- Form Template Method
- Replace Temp with Query
- Extract Method
- Self Encapsulate(自封装) Field

## 5. 重构 vs 性能优化

类型|重构|性能优化
----|----|----
内部结构|改变|改变
外部行为|不改变或很小改变|不改变（除了执行速度）
目的|软件更容易被理解和修改，性能没有变化|性能提升，但往往使代码较难理解
